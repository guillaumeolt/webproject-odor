{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="theme-color" content="#000000"/>
    <meta name="description" content="Ketcher is a web-based chemical structure editor"/>
    <link rel="shortcut icon" type="image/x-icon" href="./favicon.ico"/>
    <link rel="icon" type="image/png" sizes="32x32" href="./favicon-32x32.png"/>
    <link rel="icon" type="image/png" sizes="16x16" href="./favicon-16x16.png"/>
    <link rel="apple-touch-icon" sizes="180x180" href="./apple-touch-icon.png"/>
    <link rel="manifest" href="./manifest.json"/>
    <title>Ketcher v2.3.3-297-ga6f91d0d</title>
    <link href="{% static 'css/2.1a1d4f17.chunk.css' %}'" rel="stylesheet">
    <link href="{% static 'css/main.4b33aa94.chunk.css' %}" rel="stylesheet">

	<link rel="stylesheet" href="{% static 'css/sortable.min.css' %}" />
	<script src="{% static 'js/sortable.min.js' %}"></script>

    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="{% static 'css/style_website_or.css' %}">


	<script src="{% static 'js/jquery.min.js' %}"></script>
    <title>OdorFinder/OdorPred (to change)</title>

	<link rel="stylesheet" href="{% static 'css/style_website.css' %}">

    <script src="{% static 'js/ngl.js' %}"></script>
    <!-- BOKEH -->
    <link href=”http://cdn.pydata.org/bokeh/release/bokeh-2.4.2.min.css" rel=”stylesheet” type=”text/css”>
    <link href=”http://cdn.pydata.org/bokeh/release/bokeh-widgets-2.4.2.min.css" rel=”stylesheet” type=”text/css”>
</head>
<body class="home">
    <!-- Fixed navbar -->
    <div class="navbar" >
        <div class="navbar-container">
            <div class="navbar-header">
                <a class="navbar-brand" href="{% url 'OdorWebSite_Home' %}"><img src="assets/images/logo.png" alt="OdorWebSiteLogo"></a>
            </div>
            <!-- Button for smallest screens -->
            <a href="#" class="navbar-toggle">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>
            <div class="navbar-collapse">
                <ul class="navbar-items">
                    <li><a href="{% url 'OdorWebSite_Home' %}">Home</a></li> <!-- <li class="active"><a href="#"> -->
                    <li><a href="{% url 'OdorWebSite_About' %}">About</a></li> <!-- <li><a href="{% url 'OdorWebSite_About' %}"> -->
                    <li><a href="{% url 'search_chem_or_odor' %}">Search</a></li>
                    <li class="deroulant"><a href="#">Tools</a>
                        <ul class="sous">
                            <li><a href="{% url 'OdorWebSite_Search' %}">Structure Search</a></li>
                            <li><a href="{% url 'OdorWebSite_Predict' %}">Predict</a></li>
                            <li><a href="{% url 'docking_chem_or' %}">Docking</a></li>
                        </ul>
                    </li>
                    <!--
                    <li><a href="{% url 'OdorWebSite_Search' %}">Structure Search</a></li>
                    <li><a href="{% url 'OdorWebSite_Predict' %}">Predict</a></li>
                    <li><a href="{% url 'docking_chem_or' %}">Docking</a></li>-->
                    <li><a href="{% url 'OdorWebSite_Contact' %}">Contact</a></li>
                </ul>
            </div>
        </div>
    </div>
    <script>
    const toggleButton = document.getElementsByClassName('navbar-toggle')[0];
    const navbarLinks = document.getElementsByClassName('navbar-collapse')[0];
    toggleButton.addEventListener('click', () => {
        console.log("ok");
      navbarLinks.classList.toggle('active');
    });
    </script>
    <!-- /.navbar -->
    <!-- OR content -->
    <main>
    <div>
        <h1>Olfactory Receptor : {{ GeneName.GeneName }}</h1>
    </div>
    <h2>3D View:</h2>
    <div id="container_visualisation_OR">
        <div id="viewport" style="width:100%; height:100%;"></div>
    </div>
        <div class="or_sequence">
            <p>Amino acid conceptual sequence: {{ GeneName.Sequence }}</p>
        </div>
    <script>
        var GeneName_or_pdb  = "{{ GeneName.FileName_3D_Structure }}";
        var path_pdb_or = "{% static 'media/db_prots/' %}{{ GeneName.FileName_3D_Structure }}";
        console.log(path_pdb_or);
    </script>
    <script src="{% static 'js/code_or.js' %}"></script>

    <h1>Radar plot:</h1>
    {% block content %}
        {% autoescape off %}
        {{ div_radar_plot }}
        {% endautoescape %}
    {% endblock content%}
    <h1>Umap OR:</h1>
      {{div| safe}}
   <script src="https://cdn.bokeh.org/bokeh/release/bokeh-2.4.2.min.js"></script>
   <script src="https://cdn.bokeh.org/bokeh/release/bokeh-widgets-2.4.2.min.js"></script>
   <script src="https://cdn.bokeh.org/bokeh/release/bokeh-tables-2.4.2.min.js"></script>
   <script src="https://cdn.bokeh.org/bokeh/release/bokeh-api-2.4.2.min.js"></script>
   {{script| safe}}
    <div><h1>OR phylogenic tree</h1></div>
    <div>
        <img src="{% static 'media/phylogenic_tree_OR/' %}{{ GeneName.GeneName }}.svg" style="display:block;" width="100%" height="100%">
    </div>
    <h2>Select compound for docking:</h2>
        <form method="post" action="{% url 'docking_chem_or' %} " target="_blank">
        {% csrf_token %}
            <div class="tab-content">
              <div class="tab-pane active" id="chem-tab-pane" role="tabpanel" aria-labelledby="chem-tab">
                  <input type="text" id="search_chemical" name="search_chemical" placeholder="Search Chemicals by name, cas, smile, PubChem CID"></input>
                  <input type="text" id="search_or" name="search_or" style="display:none" value="{{ GeneName.FileName_3D_Structure }}"></input>
                  <button type="submit" id="btn_search_chem" name="btn_search_chemical">Launch seamdock</button>
                  <script>
                      var availableTags = [
                                           {% for chem in chemicals_odors %}
                                               "{{chem.CAS | safe}}", "{{chem.Name | addslashes}}",
                                           {% endfor %}
                                           ];

                      var availableTags_dict_chem = {
                          {% for chem in chemicals_odors %}
                          "{{ chem.idChemicals }}": {CAS: "{{chem.CAS | safe}}",
                                                     Name:"{{chem.Name | addslashes}}"},
                          {% endfor %}
                      };
                  </script>
              </div>
            </div>
        </form>
            <div class="relative">
                <div class="autocomplete_container" id="autocomplete_container"></div>
            </div>
            <div class="selection_to_dock_chem" id="selection_to_dock_chem">
                  <p> Molecule to dock to the OR:</p>
            </div>
    </div>
            <script type="text/javascript" src="{% static 'js/code_docking.js' %}"></script>
    <div><h2>Molecules:</h2></div>
    <div class="container_tab_odor">
        <table id="myTable" class="table_db_odor"> <!-- class="table_db_odor" -->
            <thead>
              <tr class="header">
                    <th>Image</th>
                    <th>ID</th>
                    <th>Name</th>
                    <th>CAS</th>
                    <th>PubChem CID</th>
                    <th>SMILE</th>
              </tr>
            </thead>
            <tbody>
            {% for key, db_infos in dic_or_chem.items %}
                <tr>
                    <td class="col2"><img src="{% static 'media/db_mols_svg/' %}{{db_infos.idChemicals}}.svg" style="display:block;" width="50%" height="50%"></td>
                    <td class="col2">
                        <a href="{% url 'OdorWebSite_Chemical' chem_id=db_infos.idChemicals %}" target="_blank">
                            {{db_infos.idChemicals}}
                        </a>
                    </td>
                    <td class="col2">{{db_infos.Name}}</td>
                    <td class="col2">{{db_infos.CAS}}</td>
                    <td class="col2"><a href="https://pubchem.ncbi.nlm.nih.gov/compound/{{db_infos.Pubchem_CID}}" target="_blank">{{db_infos.Pubchem_CID}}</a></td>
                    <td class="col2">{{db_infos.SMILE}}</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
    </main>
    <!-- ./About content -->
    <!-- Footer -->
    <footer id="footer">
        <div class="container-footer">
            <div class="row">
                <div class="footer-content Contact">
                    <h3 class="footer-title">Contact</h3>
                    <div class="widget-body">
                        <p>+3615odor<br>
                        <a href="mailto:#">some.email@somewhere.com</a>
                        <br>
                            Université Paris Cité
                        <br>
                            Bâtiment Lamarck A
                        <br>
                            35 rue Hélène Brion, 75205, Paris Cedex 13
                        </p>
                    </div>
                </div>

                <div class="footer-content Follow">
                    <h3 class="footer-title">Follow</h3>
                    <div class="widget-body">
                        <a href="https://www.inserm.fr/en/home/">
                            <img src="{% static 'media/logos/inserm_logo2.png' %}">
                        </a>
                        <a href="https://u-paris.fr/en/">
                            <img src="{% static 'media/logos/logo_paris.png' %}">
                        </a>
                        <a href="https://systox.u-paris-sciences.fr/">
                            <img src="{% static 'media/logos/logo_systox.png' %}">
                        </a>
                        <a href="https://www2.dijon.inrae.fr/csga/index_eng.php">
                            <img class="csga" src="{% static 'media/logos/logo-csga.png' %}">
                        </a>
                        <a href="http://bfa.univ-paris-diderot.fr/equipe-8/?lang=en">
                            <img src="{% static 'media/logos/bfa-logo.png' %}">
                        </a>
                    </div>
                </div>
                <div class="footer-content Funding">
                    <h3 class="footer-title">Funding</h3>
                    <div class="widget-body">
                        This website was funded by Agence Nationale de la Recherche, ANR-18-CE21-0006-01 MULTIMIX.
                        <a href="https://anr.fr/Projet-ANR-18-CE21-0006">
                            <img src="{% static 'media/logos/ANR-logo-2021-sigle.svg' %}">
                        </a>
                    </div>
                </div>
            </div>
            <div class="copyright">
                Copyright © 2022
            </div>
        </div>
    </footer>
    <!-- /Footer -->
</body>
</html>